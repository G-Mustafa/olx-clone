!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){const n={offset:{suggestions:0,recentSearches:0,search:0},searchQuery:""};class o{constructor(e){this.method="POST",this.mode="cors",this.cache="no-cache",this.credentials="include",this.headers={"Content-Type":"application/json"},this.body=JSON.stringify(e)}}const a={method:"GET",credentials:"include",mode:"cors",cache:"no-cache"};function s(e,t){let n=document.getElementById("msg-box");n.innerHTML="clear"==e?"":`<div class="alert alert-${t}" role="alert">${e}</div>`}async function l(e){try{const{latitude:t,longitude:n}=e.coords,o=(await i(`geocode/v1/json?key=dc6bb74b6b72464d8ad2276b41daec5d&q=${t}%2C%20${n}&pretty=1&no_annotations=1`,void 0,"https://api.opencagedata.com/","Failed to detect location")).results[0].components.country;if(!["Pakistan","India","Bangladesh"].includes(o))throw new Error("Country not supported.Select location.");document.getElementById("location").value=o,d(!0,{types:["suggestions","recentSearches"],offset:0,country:o},"")}catch(e){console.log("d"),s(e.message,"danger")}}async function i(e,t,n="https://localhost:3000/",o="Server encountered an error"){const a=await fetch(n+e,t);if(!a.ok)throw new Error(o);return await a.json()}const r=document.getElementById("location");function c(e,t){const n={string:"",number:0};for(let o=0;o<t.length;o++){const a=typeof e[t[o]];e[t[o]]=n[a]}}async function d(e,t,a){try{const s=await i(a,new o(t));if(e)!function(e){const t={suggestions:"Suggestions",recentSearches:"Recent Searches",search:`Search results for:${n.searchQuery}`};let o="";for(const n in e)o+=`<div class="row">\n    <h2 class="heading">${t[n]}</h2>\n    <div id="${n}" class="row">`+u(e[n],n)+`</div></div>\n    <button id="${n}Btn" ${e[n].length<10?"disabled":""} name="${n}" type="button" class="btn btn-outline-primary load-more">\n    Load More</button>`;document.getElementById("app").innerHTML=o}(s);else{!function(e,t){t.length<10&&(document.getElementById(e+"Btn").disabled=!0);t.length&&document.getElementById(e).insertAdjacentHTML("beforeend",u(t,e))}(...Object.entries(s)[0])}}catch(e){console.log("f"),s(e.message,"danger")}}function u(e,t){let o="";n.offset[t]+=10;for(let t=0;t<e.length;t++)o+=`<div class="card col-sm-6 col-md-4 col-lg-3 m-2"><img class="card-img-top ad-img" src="https://localhost:3000/static/ads/${e[t].ad_id}" alt="Card image cap"><div class="card-body"><h5 class="card-title">${e[t].title}</h5><button name="${e[t].ad_id}" class="btn btn-primary card-btn">more info</button></div></div>`;return o}async function m(e){const t=document.getElementById("header-list");t.innerHTML=`<li class="nav-item"><button name="Sell" class="btn btn-outline-success m-2">Sell</button></li><li class="nav-item dropdown"><a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown"><img src="https://localhost:3000/static/profiles/${e}" width="40" height="40" class="rounded-circle"></a><div class="dropdown-menu dropdown-menu-right"><a name="Settings" href="#" class="dropdown-item">Settings</a><div class="dropdown-divider"></div><a name="Logout" href="#" class="dropdown-item">Logout</a></div></li>`,t.onclick=async function(e){const n=e.target.name;if("Sell"===n);else if("Logout"===n)try{await i("users/logout",a),t.onclick=null,g()}catch(e){console.log("a"),s(e.message,"danger")}}}function g(){document.getElementById("header-list").innerHTML='<li class="nav-item"><button name="Login" class="btn btn-outline-primary m-2" data-toggle="modal" data-target="#Modal">Login</button></li><li class="nav-item"><button name="Signup" class="btn btn-outline-primary m-2" data-toggle="modal" data-target="#Modal">Signup</button></li><div class="modal fade" id="Modal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="ModalLabel"></h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button></div></div></div></div>',$("#Modal").on("show.bs.modal",(function(t){const n=t.relatedTarget.name;document.getElementById("ModalLabel").textContent=n,"Login"===n?e.innerHTML='<button name="loginFacebook" type="button" class="btn btn-outline-primary modal-btn">Login with Facebook</button><button name="loginGoogle" type="button" class="btn btn-outline-danger modal-btn">Login with Google</button><button name="loginEmail" type="button" class="btn btn-outline-success modal-btn">Login with Email</button>':"Signup"===n&&(e.innerHTML='<form><div class="form-group"><label for="inputEmail">Email address</label><input name="inputEmail" type="email" class="form-control" id="inputEmail" aria-describedby="emailHelp" placeholder="Enter email"><small id="emailHelp" class="form-text text-muted">We\'ll never share your email with anyone else.</small></div><div class="form-group"><label for="inputPassword">Password</label><input name="inputPaswword" type="password" class="form-control" id="inputPassword" placeholder="Password"></div><div class="form-group"><label for="inputFullName">Full name</label><input name="inputFullName" type="text" class="form-control" id="inputFullName" placeholder="Randy Orton"></div><button data-dismiss="modal" type="button" name="signup" class="btn btn-primary">Sign up</button></form>')}));const e=document.getElementsByClassName("modal-body")[0];e.onclick=async function(t){if("BUTTON"!==t.target.tagName)return;const n=t.target.name;if(["loginFacebook","loginGoogle","loginEmail"].includes(n)){if("loginEmail"===n){const t='<form><div class="form-group"><label for="inputEmail">Email address</label><input name="inputEmail" type="email" class="form-control" id="inputEmail" aria-describedby="emailHelp" placeholder="Enter email"><small id="emailHelp" class="form-text text-muted">We\'ll never share your email with anyone else.</small></div><div class="form-group"><label for="inputPassword">Password</label><input name="inputPassword" type="password" class="form-control" id="inputPassword" placeholder="Password"></div><button data-dismiss="modal" type="button" name="login" class="btn btn-primary">Login</button></form>';e.innerHTML=t}}else try{const e=t.target.parentNode.inputEmail.value,a=t.target.parentNode.inputPassword.value;if(!e||!a)return;if("login"===n){const t=await i("users/login",new o({email:e,password:a}));if(t.err)throw new Error(t.err);m(t.id)}else if("signup"===n){const n=t.target.parentNode.inputFullName.value;if(!n)return;const s=await i("users/signup",new o({email:e,password:a,fullName:n}));if(s.err)throw new Error(s.err);m(s.id)}}catch(e){console.log("b"),s(e.message,"danger")}}}r.onchange=function(){const e=r.value;"none"!==e&&(s("clear"),c(n.offset,["search","suggestions","recentSearches"]),c(n,["searchQuery"]),d(!0,{types:["suggestions","recentSearches"],offset:0,country:e},""))},function(){const e=document.getElementById("search-form");e.onsubmit=function(t){t.preventDefault();const o=e.search.value;o&&o!==n.searchQuery&&(n.searchQuery=o,c(n.offset,["search"]),d(!0,{searchQuery:o,offset:n.offset.search},"search"))},document.getElementById("app").onclick=async function(e){if("BUTTON"!==e.target.tagName)return;const t=e.target.name;if("suggestions"===t||"recentSearches"===t)d(!1,{types:[t],offset:n.offset[t]},"");else if("search"===t)d(!1,{searchQuery:n.searchQuery,offset:n.offset.search},"search");else try{const{details:n,issuedat:a,fullname:s,user_id:l,price:r}=await i("ad",new o({ad_id:t}));n&&a&&s&&l&&r&&function(e,t,n,o,a,s,l){const i=`<img class='ad-img' src="https://localhost:3000/static/ads/${a}"><div><h3 class='ad-title'>${s}</h3><p>${e}</p></div>`,r=`<div>${l}<br>Issued At: ${t.slice(0,10)}</div><h3>Seller Information</h3><img src='https://localhost:3000/static/profiles/${o}'>${n}`;document.getElementById("app").innerHTML=`<div class="row">\n  <div class="col-sm-12 col-lg-8">${i}</div>\n  <div class="col-sm-12 col-lg-4">${r}</div>\n  </div>`}(n,a,s,l,t,e.target.previousSibling.textContent,r)}catch(e){console.log("c"),s(e.message,"danger")}},async function(){try{const e=await i("users/login",a);e.id?m(e.id):g()}catch(e){console.log("e"),s(e.message,"danger")}}(),navigator.geolocation?navigator.geolocation.getCurrentPosition(l):s("Select location","warning")}()}]);